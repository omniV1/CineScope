@using CineScope.Shared.Models
@using MongoDB.Bson

<div class="card h-100">
    <img src="@Movie.PosterUrl" class="card-img-top" alt="@Movie.Title"
         style="height: 300px; object-fit: cover;"
         onerror="this.src='https://via.placeholder.com/300x450?text=No+Image'">
    <div class="card-body">
        <h5 class="card-title">@Movie.Title</h5>
        <p class="card-text">
            <small class="text-muted">Released: @Movie.ReleaseDate.Year</small>
        </p>
        <p class="card-text">
            <span class="badge bg-primary">@Movie.AverageRating.ToString("0.0")</span>
            <small class="text-muted">(@Movie.ReviewCount reviews)</small>
        </p>
        <p class="card-text">
            @foreach (var genre in Movie.Genres)
            {
                <span class="badge bg-secondary me-1">@genre</span>
            }
        </p>
        @{
            // Debug info
            var idValue = Movie.Id;
            var idString = idValue.ToString();
            var idType = idValue.GetType().FullName;
            var isEmptyId = idValue == ObjectId.Empty;
        }

        <!-- Debug info -->
        <div class="card-text mb-2">
            <small>ID: @idString</small><br />
            <small>Type: @idType</small><br />
            <small>IsEmpty: @isEmptyId</small>
        </div>

        @if (idValue == ObjectId.Empty || idString == "000000000000000000000000")
        {
            <p class="text-danger">Invalid ID for this movie</p>
            <button class="btn btn-secondary" disabled>View Details</button>
        }
        else
        {
            <a href="@($"/movie/{idString}")" class="btn btn-primary">View Details</a>
        }
    </div>
</div>

@code {
    [Parameter]
    public MovieModel Movie { get; set; }
}